let api="https://mosansa-api.vercel.app/";async function main(){if(localStorage.getItem("username")&&localStorage.getItem("password")&&document.querySelector("#user")){let e=localStorage.getItem("username"),a=localStorage.getItem("password"),t=await fetch(api+"api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:a})});200==(await t.json()).status&&showUser(e)}}function showUser(e){document.querySelector("#user").classList.remove("hidden"),document.querySelector("#name").innerText=`Selamat datang, ${e}!`}async function submit(){let e=document.getElementById("date").value,a=document.getElementById("idAcara").value,t=document.getElementById("namaAcara").value,o=document.getElementById("deskripsi").value,n=document.getElementById("link").value,l=await fetch(api+"api/addFolder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tanggal:e,idAcara:a,namaAcara:t,deskripsiAcara:o,url:n,user:localStorage.getItem("username"),username:localStorage.getItem("username"),password:localStorage.getItem("password")})}),i=await l.json();console.log(i),200==i.status?alert("Berhasil menambahkan acara!"):alert("Gagal menambahkan acara!")}async function loadData(){if(!document.querySelector("#acara-table"))return;console.log("Loading Data");let e=await fetch(api+"api/allFolders"),a=await e.json();if(console.log(a.message),200===a.status){let e=document.getElementById("acara-table"),t="";for(let e=0;e<a.message.length;e++){let o=a.message[e];t+=`\n            <tbody>\n        <tr class="bg-white">\n            <td class="px-4 py-2">${o.namaAcara}</td>\n            <td class="px-4 py-2">${o.idAcara}</td>\n            <td class="px-4 py-2"><button data-tooltip-target="tooltip-${o.idAcara}" type="button" class="text-white bg-mpk-700 hover:bg-mpk-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:focus:ring-blue-800">Link</button>\n            <div id="tooltip-${o.idAcara}" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">\n                ${o.url}\n                <div class="tooltip-arrow" data-popper-arrow></div>\n            </div></td>\n            <td class="px-4 py-2">${o.tanggal}</td>\n            <td class="px-4 py-2"><button onclick="deleteId('${o.idAcara}')" class="btn btn-primary">Delete</button></td>\n        </tr>\n        </tbody>\n        `}console.log(t),e.innerHTML+=t,e.classList.add("table-auto")}}async function deleteId(e){if(!confirm("Yakin kah ?"))return;let a=await fetch(api+"api/remFolder",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:localStorage.getItem("username"),password:localStorage.getItem("password"),idAcara:e})}),t=await a.json();console.log(t),200===t.status?(alert(t.message),document.location.reload()):alert(t.message)}async function loadGrid(){if(!document.getElementById("grid-galeri"))return;let e=await fetch(api+"api/allFolders"),a=await e.json();if(console.log(a.message),200===a.status)for(let e=0;e<a.message.length;e++){let t=a.message[e],o=getDriveIdFromUrl(t.url);console.log(o);let n=await fetch(api+"api/getFiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:o})}),l=await n.json();if(console.log(l),"application/vnd.google-apps.folder"==l.files[0].mimeType){let e=await fetch(api+"api/getFiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:l.files[0].id})});l=await e.json()}console.log(l);let i=l.files.find((e=>e.mimeType.startsWith("image/")));console.log(i),document.getElementById("grid-galeri").innerHTML+=`\n            <div class="card w-96 mt-12 bg-base-100 shadow-xl image-full m-auto">\n  <figure><img src="https://drive.google.com/uc?id=${i.id}&export=download" /></figure>\n  <div class="card-body">\n    <h2 class="card-title">${t.namaAcara}</h2>\n    <p>Tanggal ${new Date(t.tanggal).toLocaleDateString("en-GB")}</p>\n    <div class="card-actions justify-end">\n      <a class="btn btn-primary" href="./fullData.html?id=${t.idAcara}">Buka</a>\n    </div>\n  </div>\n</div>\n            `}else alert("Gagal mengambil data")}function getDriveIdFromUrl(e){const a=e.match(/\/([a-zA-Z0-9_-]{25,})/);return a?a[1]:null}main(),loadData(),loadGrid();
//# sourceMappingURL=index.0ad7daa4.js.map
